<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro de Cliente</title>
    <link rel="stylesheet" href="/stylesheets/formulario.css">
    <script src="/javascripts/datos.js"></script> <!-- Incluye datos.js -->
</head>
<body>
    <h2>Formulario de Ingreso de Cliente</h2>
    <form id="formCliente">
        <label for="ci">Cédula de Identidad:</label>
        <input type="text" id="ci" name="ci" required><br><br>

        <label for="nombre">Nombre Completo:</label>
        <input type="text" id="nombre" name="nombre" required><br><br>

        <label for="fecha_nacimiento">Fecha de Nacimiento:</label>
        <input type="date" id="fecha_nacimiento" name="fecha_nacimiento"><br><br>

        <label for="nacionalidad">Nacionalidad:</label>
        <input type="text" id="nacionalidad" name="nacionalidad"><br><br>

        <label for="telefono">Teléfono:</label>
        <input type="tel" id="telefono" name="telefono"><br><br>

        <label for="provincia">Provincia:</label>
        <input type="text" id="provincia" name="provincia"><br><br>

        <label for="canton">Cantón:</label>
        <input type="text" id="canton" name="canton"><br><br>

        <label for="parroquia">Parroquia:</label>
        <input type="text" id="parroquia" name="parroquia"><br><br>

        <label for="barrio">Barrio:</label>
        <input type="text" id="barrio" name="barrio"><br><br>

        <label for="calles">Calles:</label>
        <input type="text" id="calles" name="calles"><br><br>

        <button type="submit">Guardar Cliente</button>
    </form>
    <button onclick="window.location.href='menu_admin.html'">Volver al Menú Principal</button>

    <script>
        // Manejar la sumisión del formulario
        document.getElementById('formCliente').addEventListener('submit', function(e) {
            e.preventDefault(); // Evita el envío tradicional del formulario

            // Obtener los valores del formulario
            const ci = document.getElementById('ci').value.trim();
            const nombre = document.getElementById('nombre').value.trim();
            const fecha_nacimiento = document.getElementById('fecha_nacimiento').value;
            const nacionalidad = document.getElementById('nacionalidad').value.trim();
            const telefono = document.getElementById('telefono').value.trim();
            const provincia = document.getElementById('provincia').value.trim();
            const canton = document.getElementById('canton').value.trim();
            const parroquia = document.getElementById('parroquia').value.trim();
            const barrio = document.getElementById('barrio').value.trim();
            const calles = document.getElementById('calles').value.trim();

            // Validar campos obligatorios
            if (!ci || !nombre) {
                alert('Por favor, completa los campos obligatorios.');
                return;
            }

            // Verificar si ya existe un cliente con la misma CI
            const clientesExistentes = obtenerClientes().map(cliente => cliente.ci);
            if (clientesExistentes.includes(ci)) {
                alert('Ya existe un cliente con esta Cédula de Identidad.');
                return;
            }

            // Crear un objeto cliente
            const nuevoCliente = {
                id: Date.now(), // ID único basado en la marca de tiempo
                nombre,
                ci,
                telefono,
                direccion: {
                    provincia,
                    canton,
                    parroquia,
                    barrio,
                    calles
                },
                fecha_nacimiento,
                nacionalidad
            };

            // Añadir el nuevo cliente al array
            agregarCliente(nuevoCliente);

            // Mostrar un mensaje de éxito
            alert('Cliente registrado exitosamente.');

            // Limpiar el formulario
            document.getElementById('formCliente').reset();
        });
    </script>
</body>
</html>
